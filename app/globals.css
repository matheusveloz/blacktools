@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 2%;
    --foreground: 0 0% 100%;
    --card: 0 0% 4%;
    --card-foreground: 0 0% 100%;
    --popover: 0 0% 5%;
    --popover-foreground: 0 0% 100%;
    --primary: 142 71% 45%;
    --primary-foreground: 0 0% 0%;
    --secondary: 0 0% 9%;
    --secondary-foreground: 0 0% 100%;
    --muted: 0 0% 13%;
    --muted-foreground: 0 0% 54%;
    --accent: 0 0% 13%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 0 0% 13%;
    --input: 0 0% 13%;
    --ring: 142 71% 45%;
    --radius: 12px;

    /* Custom colors */
    --gray-950: 0 0% 2%;
    --gray-900: 0 0% 4%;
    --gray-850: 0 0% 6%;
    --gray-800: 0 0% 9%;
    --gray-700: 0 0% 13%;
    --gray-600: 0 0% 20%;
    --gray-500: 0 0% 29%;
    --gray-400: 0 0% 42%;
    --gray-300: 0 0% 54%;
    --green: 142 71% 45%;
    --green-dark: 142 76% 36%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-family: 'Inter', system-ui, sans-serif;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--gray-700));
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--gray-600));
}

/* Workflow canvas grid */
.workflow-canvas {
  background-image:
    radial-gradient(circle at 50% 30%, rgba(255,255,255,0.02) 0%, transparent 50%),
    linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
  background-size: 100% 100%, 25px 25px, 25px 25px;
}

/* Node connection line styles */
.connection-line {
  stroke: hsl(var(--gray-500));
  stroke-width: 2;
  fill: none;
}

.connection-line.active {
  stroke: hsl(var(--green));
  stroke-width: 2.5;
}

.connection-line-preview {
  stroke: hsl(var(--foreground));
  stroke-width: 2;
  stroke-dasharray: 6 4;
  fill: none;
  animation: dash-flow 0.4s linear infinite;
}

@keyframes dash-flow {
  to { stroke-dashoffset: -10; }
}

/* Port styles */
.port {
  @apply absolute rounded-full cursor-crosshair transition-all duration-150;
  /* Larger touch area on mobile */
  width: 16px;
  height: 16px;
  background: hsl(var(--muted));
  border: 2px solid hsl(var(--border));
  z-index: 50;
  pointer-events: auto;
}

/* Larger ports on touch devices */
@media (hover: none) and (pointer: coarse) {
  .port {
    width: 28px;
    height: 28px;
    border-width: 3px;
  }

  .port.input {
    left: -14px;
    margin-top: -14px;
  }

  .port.output {
    right: -14px;
    margin-top: -14px;
  }
}

.port:hover {
  transform: scale(1.3);
  background: hsl(var(--primary));
  border-color: hsl(var(--primary));
}

.port.connected {
  background: hsl(var(--primary));
  border-color: hsl(var(--primary));
}

/* Hover effect when dragging a connection over a valid target port */
.port.port-hover {
  transform: scale(1.5);
  background: hsl(var(--primary));
  border-color: hsl(var(--primary));
  box-shadow: 0 0 0 4px hsl(var(--primary) / 0.3);
}

.port.input {
  left: -8px;
  top: 50%;
  margin-top: -8px;
}

.port.output {
  right: -8px;
  top: 50%;
  margin-top: -8px;
}

/* Spin animation */
@keyframes spin {
  to { transform: rotate(360deg); }
}

.animate-spin {
  animation: spin 0.6s linear infinite;
}

/* Shimmer animation */
@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.animate-shimmer {
  animation: shimmer 2s infinite;
  background: linear-gradient(
    90deg,
    hsl(var(--muted)) 0%,
    hsl(var(--muted) / 0.3) 20%,
    hsl(var(--muted) / 0.5) 60%,
    hsl(var(--muted) / 0.3) 80%,
    hsl(var(--muted)) 100%
  );
  background-size: 1000px 100%;
}

/* Neon border animation for pricing card */
@keyframes neon-border {
  0%, 100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

.neon-card {
  position: relative !important;
  overflow: visible !important;
  isolation: isolate;
}

.neon-card::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 14px;
  background: linear-gradient(
    90deg,
    hsl(142 71% 45%) 0%,
    hsl(142 71% 65%) 25%,
    hsl(142 71% 45%) 50%,
    hsl(142 71% 65%) 75%,
    hsl(142 71% 45%) 100%
  );
  background-size: 200% 100%;
  animation: neon-border 3s ease-in-out infinite;
  z-index: -1;
}

.neon-card::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 12px;
  background: hsl(var(--card));
  z-index: -1;
}

/* Optimized scroll performance */
.will-change-scroll {
  will-change: scroll-position;
  -webkit-overflow-scrolling: touch;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Prevent page zoom on mobile - only allow canvas zoom */
html, body {
  touch-action: pan-x pan-y;
  overscroll-behavior: none;
}

/* Dynamic viewport height for mobile (handles virtual keyboard) */
.h-dvh {
  height: 100vh;
  height: 100dvh;
}

/* Prevent layout shift when keyboard opens */
@supports (height: 100dvh) {
  .h-dvh {
    height: 100dvh;
  }
}

/* Prevent scroll on mobile dashboard ONLY - use .no-scroll class on body */
.no-scroll {
  overflow: hidden;
  position: fixed;
  width: 100%;
  height: 100%;
}

/* Canvas container - allow pinch zoom only inside */
.workflow-canvas-container {
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Allow text selection in inputs and textareas inside canvas */
.workflow-canvas-container input,
.workflow-canvas-container textarea,
.workflow-canvas-container select {
  touch-action: auto;
  -webkit-user-select: text;
  user-select: text;
}

/* Ensure no zoom on touch devices - iOS requires 16px+ font to prevent auto-zoom */
@media (hover: none) and (pointer: coarse) {
  /* Force 16px minimum on all form inputs to prevent iOS auto-zoom */
  input, textarea, select {
    font-size: 16px !important;
    -webkit-text-size-adjust: 100%;
  }
}

/* Touch manipulation for better button response on mobile */
.touch-manipulation {
  touch-action: manipulation;
}
